# hit
using System;using System.Collections.Generic;using System.Linq;using System.Diagnostics;using Microsoft.Xna.Framework;using Microsoft.Xna.Framework.Audio;using Microsoft.Xna.Framework.Content;using Microsoft.Xna.Framework.GamerServices;using Microsoft.Xna.Framework.Graphics;using Microsoft.Xna.Framework.Input;using Microsoft.Xna.Framework.Media;namespace WindowsGame2{    /// <summary>    /// This is the main type for your game    /// </summary>    public class Game1 : Microsoft.Xna.Framework.Game    {        GraphicsDeviceManager graphics;        SpriteBatch spriteBatch;        private Model boxModel;        private Matrix[] boxTransform;        private Matrix boxWorld;        private int boxPositionCount = 0;        private Matrix transform;        private Vector3 scale;        private Model yureiModel;        private Matrix[] yureiTransform;        private Matrix yureiWorld;        private Vector3 rotation;        private float boxsize = 100.0f;        private BoundingBox boundBox;        private BoundingSphere sphere1;        private BoundingSphere sphere2;        private Ray ray1; //中心        private Texture2D flame;        private Vector2 flamePosition;          //フレームの場所        private Vector2 flameCenterPosition;    //フレームの中心座標        private Vector3 cameraTargetPosition;        private Vector3 boxPosition;        private Vector3 cameraPosition;        private Vector3 yureiPosition;        private Matrix view;        private Matrix projection;        DynamicVertexBuffer vertexBuffer = null;        KeyboardState keyboardState;        public Game1()        {            graphics = new GraphicsDeviceManager(this);            Content.RootDirectory = "Content";            graphics.PreferredBackBufferWidth = 1280;            graphics.PreferredBackBufferHeight = 720;        }        /// <summary>        /// Allows the game to perform any initialization it needs to before starting to run.        /// This is where it can query for any required services and load any non-graphic        /// related content.  Calling base.Initialize will enumerate through any components        /// and initialize them as well.        /// </summary>        protected override void Initialize()        {            // TODO: Add your initialization logic here            InitializeModel();            InitializeCamera();            base.Initialize();        }        #region モデルの読み込み        private void InitializeModel()        {            //boxModel = Content.Load<Model>("sikaku");            //boxTransform = new Matrix[boxModel.Bones.Count];            //boxModel.CopyAbsoluteBoneTransformsTo(boxTransform);            //boxPosition = new Vector3(0.0f, 0.0f, 0.0f);            //boxWorld = Matrix.CreateTranslation(boxPosition);            yureiModel = Content.Load<Model>("yurei FBXban");            yureiTransform = new Matrix[yureiModel.Bones.Count];            yureiModel.CopyAbsoluteBoneTransformsTo(yureiTransform);            yureiPosition = new Vector3(0.0f, 0.0f, 0.0f);            yureiWorld = Matrix.CreateTranslation(yureiPosition);            flame = Content.Load<Texture2D>("flame");            flameCenterPosition = new Vector2(flame.Width / 2, flame.Height / 2);   //フレームの中心座標            flamePosition = new Vector2(490.0f, 260.0f);//画面の中心        }        #endregion        #region カメラ        private void InitializeCamera()        {            float fieldOfView;            float aspectRatio;            float nearPlaneDistance;            float farPlaneDistance;            cameraPosition = new Vector3(0.0f, 0.0f, 400.0f);            cameraTargetPosition = new Vector3(0.0f, 0.0f, 0.0f);            fieldOfView = MathHelper.ToRadians(45.0f);            aspectRatio = (float)GraphicsDevice.Viewport.Width / (float)GraphicsDevice.Viewport.Height;            nearPlaneDistance = 1.0f;            farPlaneDistance = 2000.0f;            projection = Matrix.CreatePerspectiveFieldOfView(fieldOfView, aspectRatio, nearPlaneDistance, farPlaneDistance);        }        #endregion        /// <summary>        /// LoadContent will be called once per game and is the place to load        /// all of your content.        /// </summary>        protected override void LoadContent()        {            // Create a new SpriteBatch, which can be used to draw textures.            spriteBatch = new SpriteBatch(GraphicsDevice);            // TODO: use this.Content to load your game content here            //boundBox = new BoundingBox();            //boundBox.Max = new Vector3(100.0f,250.0f,100.0f)+boxPosition;            //boundBox.Min = new Vector3(-100.0f,0.0f,-100.0f)+boxPosition;            sphere1 = new BoundingSphere(new Vector3(0.0f, 0.0f, 0.0f), 200.0f);            sphere2 = new BoundingSphere(new Vector3(0.0f, 0.0f, 0.0f), 50.0f);        }        /// <summary>        /// UnloadContent will be called once per game and is the place to unload        /// all content.        /// </summary>        protected override void UnloadContent()        {
